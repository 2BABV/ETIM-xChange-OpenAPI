type: object
description: |
  Bulk response containing flattened product ETIM classification features with cursor-based pagination.
  
  **Flattened Structure**: Each row represents a single feature value within a product's ETIM classification.
  This structure is optimized for:
  - Predictable payload sizes (each row has consistent structure)
  - Efficient cursor-based pagination by feature
  - ETL/data warehouse ingestion
  - Streaming data processing
  
  **Payload Optimization**: Optional properties with null values are omitted from the response
  to minimize payload size. Clients should treat missing properties as null/not applicable.
  
  **Data Reconstruction**: To reconstruct the hierarchical structure:
  1. Group rows by `productRef` for products
  2. Within each product, group by `classificationRef` for classifications
  3. Features are individual rows within each classification group
  
  **Classification-Only Rows**: Products with classifications but no features are represented
  with `etimFeatureCode` omitted to ensure all classifications are included.
additionalProperties: false
required:
  - data
  - meta
properties:
  data:
    type: array
    description: |
      Array of flattened product ETIM classification features.
      Each item represents a single feature value for a product classification.
      
      Rows are ordered by:
      1. `productRef` (ascending)
      2. `classificationRef` (ascending)
      3. `featureRef` (ascending, nulls first)
    items:
      $ref: ../domain/ProductEtimClassificationFeature.yaml
  meta:
    $ref: ../../../../shared/schemas/common/CursorPaginationMetadata.yaml
    description: |
      Cursor-based pagination metadata.
      
      The cursor encodes the position based on the composite key:
      `productRef` + `classificationRef` + `featureRef`

examples:
  - data:
      # Product 1, Classification 1, Feature 1 (Alphanumeric)
      - productRef: "prod-001"
        classificationRef: "cls-001"
        featureRef: "feat-001"
        etimClassCode: "EC002745"
        etimClassVersion: 1
        etimReleaseVersion: "9.0"
        etimFeatureCode: "EF000123"
        etimValueCode: "EV000789"
      # Product 1, Classification 1, Feature 2 (Numeric)
      - productRef: "prod-001"
        classificationRef: "cls-001"
        featureRef: "feat-002"
        etimClassCode: "EC002745"
        etimClassVersion: 1
        etimReleaseVersion: "9.0"
        etimFeatureCode: "EF000456"
        etimValueNumeric: 230.0
      # Product 1, Classification 1, Feature 3 (Logical)
      - productRef: "prod-001"
        classificationRef: "cls-001"
        featureRef: "feat-003"
        etimClassCode: "EC002745"
        etimClassVersion: 1
        etimReleaseVersion: "10.0"
        etimFeatureCode: "EF000789"
        etimValueLogical: true
      # Product 2, Classification without features
      - productRef: "prod-002"
        classificationRef: "cls-002"
        etimClassCode: "EC001234"
        etimClassVersion: 2
        etimReleaseVersion: "11.0"
    meta:
      cursor: "eyJtYW51ZmFjdHVyZXJJZEdsbkgiOiI5ODc2NTQzMjEwOTg3IiwibWFudWZhY3R1cmVyUHJvZHVjdE51bWJlciI6IkxFRC0xMjM0NS1BIiwiZXRpbUNsYXNzQ29kZSI6IkVDMDAxMjM0IiwiZXRpbUZlYXR1cmVDb2RlIjpudWxsfQ=="
      hasNext: true
      hasPrev: false
      limit: 1000
      estimatedTotal: 245830
